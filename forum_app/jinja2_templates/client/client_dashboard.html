{% extends "_layouts/_home.html" %}

{% block title %}Clients{% endblock %}

{% block head_link %}{% endblock %}

{% block content %}

<div class="page-content">

  <!-- <div class="breadcrumb inline">
    <a href="/shared-data/dashboard">Dashboard</a>
    <span class="material-icons">chevron_right</span>
    <span>Market identifier codes</span>
  </div> -->

  <div class="container">
    <div class="row">
      <div class="col s12">
        <form method="post" id="search_form">
          <div class="input-field inline">
            <input type="text" id="client_name_field" name="client_name_field" value="{{search_term}}">
            <label for="client_name_field">Client name</label>
          </div>

          <div class="input-field inline">
            <select id="client_type" name="client_type_dropdown">
              {% for client_type in client_type_list %}
              <option value="{{ client_type[0] }}" {% if client_type[0] == selected_client_type|int %}selected{% endif %}>{{ client_type[1] }}</option>
              {% endfor %}
            </select>
            <label for="client_type">Client type</label>
          </div>

          <div class="input-field inline">
            <button class="btn waves-effect waves-light" type="submit" name="action" value="new"><i class="material-icons right" style="margin: 0;">search</i></button>
          </div>
        </form>
      </div>
    </div>

    <div class="row">
      <div class="col s6">

        {% if client_list %}

        <table>
          <thead>
            <tr>
                <th>s/n</th>
                <th>Name</th>
            </tr>
          </thead>
      
          <tbody>
            {% for client in client_list %}
            <tr>
              <td>{{client[0]}}</td>
              <td class="full-width">{{client[2]}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        {% else %}

        <p>No data matching criteria found.</p>

        {% endif %}

      </div>
      <div class="col s6"></div>
    </div>

    <div class="footer action container">
      <div class="row">

        <div class="col s6"></div>
        <div class="col s6 right-align">
          <a href="/client/new" class="btn-floating btn-large waves-effect waves-light blue"><i class="material-icons">add</i></a>
        </div>
      </div>
    </div>

  </div>

</div>

{% endblock %}

{% block scripts %}
<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('select');
    var instances = M.FormSelect.init(elems);

  function performSearch() {
    document.getElementById("search_form").submit();
  }

  document.getElementById("client_type").addEventListener("change", performSearch);

});
</script>
{% endblock %}